# GMレスLoL風TRPG - TODO リスト

このファイルは、ゲームルールとシステム設計の残タスクを管理します。

## 進行状況

- ✅ 完了
- 🔄 作業中
- ⏳ 未着手

---

## ゲームルール作成タスク

### 🔄 1. アイテムシステムのゲームルール作成

**ステータス**: 作業中（2025-11-09開始）

**理由**:
- ユーザーからのリクエスト：「アイテムの複雑さは、特殊効果も含めてほしい」「アイテム数はある程度は担保したいが、最初は少なめがいい」「アイテム合成あり」
- 現在のゲームルールには、アイテムシステムの詳細が記載されていない（gameplay_systems.mdに「今後の詳細化が必要な項目」として記載のみ）
- LoL風TRPGにおいて、アイテムはキャラクター強化の重要な要素

**作成内容**:
- [x] アイテムシステム概要
- [x] 購入とゴールド管理
- [x] 基本アイテム（コンポーネント）の定義
- [x] 上位アイテム（合成レシピ）の定義
- [x] 特殊効果（パッシブ、アクティブ）の詳細ルール
- [x] アイテムビルド戦略例

**成果物**: `docs/item_system.md`

**残作業**:
- [ ] ユーザーレビューとフィードバック対応
- [ ] 他のゲームルールとの整合性確認

---

### ✅ 2. リコールシステムのゲームルール作成

**ステータス**: 完了（2025-11-09）

**理由**:
- 現在のゲームルールでは、リコールについて簡単に触れられているが、詳細なルールが未定義
- リコールは以下の要素と密接に関連：
  - アイテム購入タイミング（リコール成功後にショップでアイテム購入可能）
  - 戦略的な位置取り（リコールするタイミングの判断）
  - ターン消費（リコールに必要なターン数）

**作成内容**:
- [x] リコール開始条件
- [x] リコール所要時間（1ターンで完了）
- [x] リコール中断条件（敵の攻撃、敵の接近、CC効果）
- [x] リコール成功後の処理（ショップでアイテム購入、HP全回復、自陣ネクサス移動）
- [x] リコール失敗時のペナルティ（1ターン消費、HP回復なし、その場に留まる）
- [x] 戦略的使用方法（安全/危険なタイミング、ゲームフェーズ別の使い方）
- [x] 具体例（成功例、中断例）

**成果物**: `docs/gameplay_systems.md`に追記

**関連ドキュメント**:
- `gameplay_systems.md` - リコールシステムの詳細を追加
- `item_system.md` - 購入タイミングとして「リコール成功後」を定義

---

### ✅ 3. 時間管理システムのゲームルール作成

**ステータス**: 完了（2025-11-09）

**理由**:
- 現在のゲームルールには「ターン」という概念はあるが、時間の具体的な定義がない
- 以下の要素を明確にする必要がある：
  - 1ターンが何秒/何分に相当するのか
  - ゲーム全体の制限時間（何ターンで終了か）
  - 序盤/中盤/終盤のフェーズ区分
  - リスポーン時間とターンの関係

**作成内容**:
- [x] 1ターンの時間定義（1ターン = 10秒）
- [x] ゲーム全体の制限時間（最大120ターン = 20分）
- [x] ゲームフェーズの定義
  - 序盤（1-30ターン / 0-5分）: レーニングフェーズ
  - 中盤（31-70ターン / 5-12分）: ガンク・オブジェクト争奪
  - 終盤（71-120ターン / 12-20分）: チーム戦・プッシュ
- [x] フェーズ移行の目安（タワー破壊、オブジェクト撃破、レベル到達）
- [x] 時間切れ時の勝敗判定基準（ネクサスHP、タワー数、ゴールド、レベル、キル数）
- [x] スキル・バフ・オブジェクトの持続時間とターン数の対応表
- [x] リスポーン時間とターン数の対応表

**成果物**: `docs/time_management.md`

**関連ドキュメント**:
- `combat_system.md` - リスポーン時間の計算式と整合性を確保
- `gameplay_systems.md` - ターン構造と整合性を確保
- `character_system.md` - スキルクールダウンとの整合性を確保

---

### ✅ 4. バフ効果の詳細ルール作成

**ステータス**: 完了（2025-11-09）

**理由**:
- 現在のゲームルールでは、バフ（赤バフ、青バフ、ドラゴン、バロン、ヘラルド）の存在は記載されているが、具体的な効果が未定義
- バフはゲームの戦略的要素の重要な部分
- JGのバフファームやオブジェクト獲得の価値を明確にする必要がある

**作成内容**:
- [x] 赤バフの詳細効果（攻撃力+2.0、スロー効果：移動力-2、持続9ターン）
- [x] 青バフの詳細効果（ユーティリティ+2.0、CDR-1ターン、持続9ターン）
- [x] ドラゴンバフの種類と効果（4種類のエレメンタルドラゴン）
  - インフェルナル（攻撃力+1.5）
  - マウンテン（防御力+1.5）
  - オーシャン（HP回復+50/ターン）
  - クラウド（移動力+1.0）
- [x] ドラゴンソウルとエルダードラゴンの効果
- [x] バロンバフの詳細効果（攻撃力+3.0、防御力+2.0、移動力+1.0、タワーダメージ+50%、持続18ターン）
- [x] ヘラルド効果（タワーに1500ダメージ、召喚型）
- [x] バフの持続時間、スタック、重複ルール
- [x] バフの戦略的使用方法（序盤/中盤/終盤別）

**成果物**: `docs/buff_system.md`

**関連ドキュメント**:
- `gameplay_systems.md` - バフファーム、オブジェクトシステムの基本
- `game_overview.md` - マップ上のバフ配置
- `time_management.md` - バフ持続時間との整合性を確保

---

### ✅ 5. 複数人戦闘システムの詳細化

**ステータス**: 完了（2025-11-10）

**理由**:
- 現在の複数人戦闘システムは基本的なルールのみ定義されている
- より詳細な戦闘解決方法、ターゲット選択、ダメージ分配などを明確化する必要がある
- 3v3、4v4、5v5などの大規模戦闘のルールが必要

**作成内容**:
- [x] 複数人戦闘の詳細なターゲット選択ルール
  - ターゲット宣言タイミング（行動宣言フェーズで同時宣言）
  - ターゲット選択の制約（視界内、同一エリア、ポジション制約）
  - ターゲット変更ルール（毎ターン変更可能）
  - 強制ターゲット（タウント、近接優先）
- [x] ポジショニングシステムの導入
  - フロントライン（タンク、ファイター）
  - バックライン（マークスマン、メイジ、サポート）
  - フレキシブル（アサシン）
  - ポジション制約によるターゲット制限
  - アサシンのバックライン突入ルール（1d20 + 移動力 ≧ 14）
  - 高移動力キャラクターの特殊ルール（移動力10以上）
- [x] ダメージ分配の計算方法
  - 複数人から攻撃を受けた場合のダメージ累積
  - 各マッチアップの独立した判定
  - フォーカスターゲットの戦略的重要性
- [x] 大規模戦闘（3v3以上）のルール
  - 数的有利ボーナスの詳細化（2v1～5v1、不均衡な戦闘）
  - 戦闘解決の流れを6ステップに体系化
    1. 配置フェーズ
    2. ターゲット宣言フェーズ
    3. 特殊判定フェーズ
    4. スキル使用フェーズ
    5. マッチアップ判定フェーズ
    6. ダメージ計算フェーズ
  - 3v3、5v5の具体例
- [x] AOE（範囲攻撃）スキルの処理
  - AOEスキルの種類（バフ、デバフ、範囲バフ）
  - ターゲット選択（最大3人または全員）
  - AOE範囲の判定（視界の要否）
  - 持続時間の管理
- [x] 戦闘中の位置取りとフォーカスターゲット
  - ポジショニングシステム
  - フォーカスターゲットの処理
  - アサシンの機動力

**成果物**: `docs/combat_system.md`の更新

**関連ドキュメント**:
- `combat_system.md` - 複数人戦闘の詳細ルールを追加
- `character_system.md` - スキルシステムとの整合性を確保
- `gameplay_systems.md` - ガンクシステムとの整合性を確保

---

### ✅ 6. ミニオンシステムとタワー攻撃メカニクスの実装

**ステータス**: 完了（2025-11-11）

**理由**:
- タワーの攻撃対象や優先順位が明確に定義されていなかった
- ミニオンとタワーの相互作用が詳細化されていなかった
- ゲームの戦略的要素を強化するため、ミニオンウェーブシステムが必要だった

**作成内容**:
- [x] ミニオンシステムの実装
  - ミニオンウェーブの生成タイミング（3ターンごと）
  - ミニオンのステータス（攻撃力、防御力、HP、移動力）
  - ミニオンの行動ルール（自動移動、自動攻撃）
  - ミニオンに対するダメージとゴールド獲得
- [x] タワー攻撃メカニクスの見直し
  - タワーの攻撃優先順位（ミニオン → タワーへ攻撃中のチャンピオン → 範囲内の敵チャンピオン）
  - タワーダメージの調整（攻撃力15.0、防御力10.0、ダメージ30-50固定）
  - ミニオンウェーブとの相互作用（ミニオンがいない状態での攻撃時のペナルティ）
- [x] タワーとミニオンのゲームルール統合

**成果物**:
- `docs/combat_system.md`の更新（タワー攻撃メカニクス）
- `docs/gameplay_systems.md`の更新（ミニオンシステム）

**関連ドキュメント**:
- `combat_system.md` - タワー攻撃の詳細ルール
- `gameplay_systems.md` - ミニオンシステムの詳細
- `game_overview.md` - マップ上のミニオン配置

---

### ✅ 7. ゲームバランス設定システムの追加

**ステータス**: 完了（2025-11-11）

**理由**:
- ゲームの数値調整を柔軟に行えるようにする必要があった
- ゲームフェーズによる動的なバランス調整が必要だった
- ロール相性による戦闘修正を体系化する必要があった

**作成内容**:
- [x] ゲームフェーズとロール相性の修正システム
  - 序盤/中盤/終盤のフェーズごとのロール補正
  - ロール相性マトリクス（タンクvsアサシン、マークスマンvsタンクなど）
  - 戦闘時の動的な修正値適用
- [x] バランス設定の集中管理
  - 数値のカスタマイズ可能化
  - ゲームバランスの調整容易化

**成果物**:
- `docs/combat_system.md`の更新（ゲームフェーズとロール相性修正）
- ゲームバランス設定システムの追加

**関連ドキュメント**:
- `combat_system.md` - フェーズ修正とロール相性修正の詳細
- `character_system.md` - ロールの定義
- `time_management.md` - ゲームフェーズの定義

---

### ✅ 8. ゲームルール全体の整合性確認と調整

**ステータス**: 完了（2025-11-11）

**理由**:
- 各ゲームルールドキュメントが個別に作成されているため、全体の整合性確認が必要
- 数値バランスの調整（ダメージ、ゴールド獲得量、アイテム価格など）
- 用語の統一（表記揺れの修正）
- ルール間の矛盾の解消

**確認内容**:
- [x] ステータス計算の整合性（キャラクター、アイテム、バフの効果が正しく累積されるか）
- [x] ゴールド経済のバランス（アイテム価格とゴールド獲得量の適正性）
- [x] 戦闘バランス（ロール間のバランス、アイテムによる強化の影響）
- [x] 用語の統一（攻撃力、防御力、マッチアップ判定などの表記）
- [x] ドキュメント間のリンク整備
- [x] 数値の不整合の修正
  - タワーHP、ゴールド報酬の統一
  - ネクサスHP、タワー防御力の統一
  - オブジェクトの出現時間、リスポーン時間の統一
  - ミニオンの生成タイミングとステータスの統一

**成果物**:
- 各ドキュメントの修正
- `game_rules.md`の更新
- ゲームルール整合性の確保

**関連ドキュメント**:
- `game_overview.md`
- `character_system.md`
- `combat_system.md`
- `gameplay_systems.md`
- `item_system.md`
- `buff_system.md`
- `time_management.md`

---

### ✅ 9. ゲームシステムの大規模な見直しと簡略化

**ステータス**: 完了（2025-11-11）

**理由**:
- ゲームの運用性を向上させるため、システムを簡略化する必要があった
- ターン制からラウンド制への移行により、より戦略的なゲームプレイを実現
- 戦闘システムの複雑さを軽減し、プレイアビリティを向上
- エリアとポジションの概念を明確化し、マップ構造を整理

**作成内容**:
- [x] エリア/ポジション定義の明確化
  - エリアとポジションを同一の概念として統一
  - 全マップエリアの定義と隣接関係の明確化
  - タワー範囲ルールの追加（レーン専用）
- [x] 視界システムの実装
  - 隣接エリアに対する視界範囲の実装
  - 視界効果レベル（最大効果/部分効果）の定義
- [x] ミニオンシステムの明確化
  - ミニオン生成ルールの明確化（レーン内に即座に出現）
  - ミニオン移動ルールの更新
- [x] バフ/デバフ管理システムの実装
  - バフ/デバフ配列システムの実装 {type, duration, value}
  - ターン開始時のクリーンアップ処理の追加
  - スキルクールダウン管理の定義 {lastUsedTurn, duration, cooldownRemaining}
  - calculateFinalStats関数の実装（効果の適用順序を定義）
- [x] ラウンドシステムへの変更
  - ターン制からラウンド制へ移行
  - 各ラウンドを「宣言フェーズ」と「解決フェーズ」に分割
  - 行動宣言に60秒の時間制限を追加
  - 詳細な解決フェーズ順序の定義（13ステップ）
  - ポジショニングシステムとガンク判定フローの実装
- [x] 戦闘システムの簡略化
  - フェーズ修正（序盤/中盤/終盤ボーナス）の削除
  - ロール相性修正の削除
  - マッチアップ判定の簡略化：1d20 + 攻撃力 + 状況修正

**成果物**:
- `docs/game_overview.md`の大幅更新（ラウンドシステム、エリア定義）
- `docs/combat_system.md`の簡略化（戦闘システムの見直し）
- `docs/buff_system.md`の更新（バフ/デバフ管理システム）
- `docs/gameplay_systems.md`の更新（ミニオンシステム）
- `docs/game_rules.md`の更新（変更履歴の追加）

**関連ドキュメント**:
- `game_overview.md` - ラウンドシステム、エリア定義、視界システム
- `combat_system.md` - 簡略化された戦闘システム
- `buff_system.md` - バフ/デバフ管理システム
- `gameplay_systems.md` - ミニオンシステム
- `game_rules.md` - 統合ドキュメント

---

### ✅ 10. ポジショニングルールの調整

**ステータス**: 完了（2025-11-11）

**理由**:
- ガンクとファーム行動時のポジショニングルールを改善
- 防御側の不利を明確にし、ゲームバランスを調整
- より直感的なポジショニングルールの実現

**作成内容**:
- [x] ガンク時のポジショニングルール変更
  - ガンクされたプレイヤー（防御側）が強制的にフロントラインに配置
  - 攻撃側ではなく防御側に不利な状況を作成
- [x] ファーム行動時のポジショニングルール変更
  - ファーム中に攻撃された場合、ファーム側が強制的にフロントラインに配置
- [x] ラウンドフロー例の更新
  - 新しいポジショニングルールを反映した例を追加
- [x] 全ドキュメントへの変更履歴の追加

**成果物**:
- `docs/combat_system.md`の更新（ポジショニングルール）
- `docs/game_overview.md`の更新（ラウンドフロー例）
- `docs/game_rules.md`の更新（変更履歴）

**関連ドキュメント**:
- `combat_system.md` - ポジショニングルール
- `game_overview.md` - ラウンドフロー例
- `game_rules.md` - 統合ドキュメント

---

### ✅ 11. プレイモードシステムとプレイヤー管理の追加

**ステータス**: 完了（2025-11-11）

**理由**:
- ユーザーから複数プレイヤーとCPU戦の要件が追加された
- プレイヤー数を柔軟に設定できるようにする必要があった
- 複数のプレイモード（カジュアル、ランク、チュートリアルなど）を定義する必要があった

**作成内容**:
- [x] game_overview.mdにプレイヤー管理システムを追加
  - キャラクター構成（5vs5）とプレイヤー数（1〜10人）の区別
  - 複数キャラクター操作システム（1人で1〜5体操作可能）
  - CPU仕様（チュートリアル、練習用）
- [x] play_modes.mdの作成
  - チュートリアルモード（1人プレイ、CPU戦、初級固定）
  - CPU練習モード（1人プレイ、難易度選択可能）
  - カジュアルモード（2〜10人、自由な対戦）
  - ランクマッチ（1vs1）（2人、各5体操作）
  - ランクマッチ（5vs5）（10人、各1体操作）
  - その他のモード（カスタムマッチ、オブザーバー、リプレイ）
- [x] game_rules.mdの更新（play_modes.mdへのリンク追加）

**成果物**:
- `docs/game_overview.md`の更新
- `docs/play_modes.md`の作成
- `docs/game_rules.md`の更新

**関連ドキュメント**:
- `game_overview.md` - プレイヤー管理とキャラクター操作
- `play_modes.md` - プレイモード詳細
- `game_rules.md` - 統合ドキュメント

---

## システム設計タスク（ゲームルール完成後）

### ✅ 12. システム設計の作成

**ステータス**: 完了（2025-11-13）

**理由**:
- ゲームルールが確定した後、それを実装するためのシステム設計が必要
- プログラム実装の前段階として、システムアーキテクチャを設計

**作成内容**:
- [x] システムアーキテクチャ設計
  - フロントエンド/バックエンド構成
  - データベース設計（Prisma + PostgreSQL）
  - WebSocket通信設計
  - API設計
- [x] 技術スタック選定
  - バックエンド: Node.js + Express + Socket.io
  - フロントエンド: React + Vite + Zustand
  - データベース: PostgreSQL + Prisma ORM
  - 言語: TypeScript
- [x] 設定管理設計
  - game_balance.yamlによる柔軟な設定管理
  - ConfigLoaderパターンの設計
- [x] ホスティング設計
  - GCP最適化設計（e2-microインスタンス、Cloud SQL）
  - 無料枠・低コスト運用プラン
- [x] 実装手順書の作成
  - フェーズごとの詳細な実装手順
  - 段階的な開発アプローチ

**成果物**:
- `docs/system/architecture.md` - システムアーキテクチャ設計
- `docs/system/technology_stack.md` - 技術スタック詳細
- `docs/system/configuration_management.md` - 設定管理設計
- `docs/system/hosting_options.md` - ホスティングオプション
- `docs/system/gcp_optimized_design.md` - GCP最適化設計
- `system_todo.md` - 実装手順書（フェーズ0〜7の詳細チェックリスト）

**関連ドキュメント**:
- すべてのゲームルールドキュメント
- 実装手順書（system_todo.md）

---

## 実装タスク（システム設計完成後）

### ✅ 13. ゲームロジック実装（フェーズ2）

**ステータス**: 完了（2025-11-13）

**理由**:
- システム設計が完了し、ゲームロジックの実装が必要
- ゲームエンジン、キャラクターシステム、戦闘システムの実装

**作成内容**:
- [x] ConfigLoader実装（game_balance.yamlの読み込み）
- [x] GameEngine実装（ゲーム状態管理）
- [x] Characterシステム（キャラクター作成、レベルアップ）
- [x] Combatシステム（マッチアップ判定、ダメージ計算）
- [x] RoundManager実装（ラウンド進行フロー）

**成果物**:
- `src/game/config/ConfigLoader.ts`
- `src/game/config/types.ts`
- `src/game/systems/Character.ts`
- `src/game/systems/Combat.ts`
- `src/game/engine/GameEngine.ts`
- `src/game/engine/RoundManager.ts`

**関連ドキュメント**:
- `system/architecture.md` - ゲームロジックのアーキテクチャ
- `system_todo.md` - 実装手順（フェーズ2）

---

### ✅ 14. フロントエンド基盤構築（フェーズ3）

**ステータス**: 完了（2025-11-13）

**理由**:
- ゲームロジックが完成し、UIの実装が必要
- React + Vite + Tailwind CSSの環境構築

**作成内容**:
- [x] Viteプロジェクトの初期化
- [x] Tailwind CSSの設定
- [x] WebSocketサービスの実装
- [x] Zustand状態管理の実装
- [x] 基本UIコンポーネント（GameBoard、CharacterCard、TowerStatus）

**成果物**:
- `src/client/` - クライアントプロジェクト全体
- `src/client/src/services/websocket.ts`
- `src/client/src/stores/gameStore.ts`
- `src/client/src/components/GameBoard.tsx`
- `src/client/src/components/CharacterCard.tsx`
- `src/client/src/components/TowerStatus.tsx`

**関連ドキュメント**:
- `system/technology_stack.md` - フロントエンド技術スタック
- `system_todo.md` - 実装手順（フェーズ3）

---

### ✅ 15. UI設計とビジュアルマップの実装

**ステータス**: 完了（2025-11-13）

**理由**:
- LoL風のビジュアルマップが必要
- 行動選択、戦闘ログなどのゲームUIが必要
- デザインシステムの統一が必要

**作成内容**:
- [x] UI設計ドキュメントの作成
  - 全体レイアウト設計
  - マップビュー詳細設計
  - 行動選択パネル設計
  - アイテムショップ設計
  - デザインシステム定義
- [x] MapView実装（LoL風SVGマップ）
  - 対角線配置（ブルー左下、レッド右上）
  - クリック可能なエリア
  - キャラクター位置表示
  - タワー・オブジェクト表示
- [x] ActionPanel実装（行動選択パネル）
  - 5つの行動ボタン（攻撃、ファーム、移動、スキル、リコール）
  - ターゲット選択
  - 残り時間表示
- [x] CombatLog実装（戦闘ログ）
  - イベントタイプ別色分け
  - 自動スクロール
  - フィルター機能

**成果物**:
- `docs/ui_design.md` - UI設計ドキュメント
- `src/client/src/components/MapView.tsx`
- `src/client/src/components/ActionPanel.tsx`
- `src/client/src/components/CombatLog.tsx`

**関連ドキュメント**:
- `docs/ui_design.md` - UI設計詳細
- `game_overview.md` - マップ構造、エリア定義

---

### ⏳ 16. 外部サービスのセットアップ（GCP最適化）

**ステータス**: 未着手

**理由**:
- GCP e2-micro（1GB RAM）でPostgreSQLとRedisを動かすとメモリ不足
- 外部サービスを活用してメモリ使用量を削減

**作成内容**:
- [ ] Supabase PostgreSQLのセットアップ（無料500MB）
- [ ] Upstash Redisのセットアップ（無料256MB、10,000コマンド/日）
- [ ] 接続文字列の取得と環境変数設定
- [ ] 接続テスト

**成果物**:
- Supabase DATABASE_URL
- Upstash REDIS_URL
- `.env`ファイルの更新

**関連ドキュメント**:
- `system/gcp_optimized_design.md` - GCP最適化設計
- `system/implementation_roadmap.md` - 実装手順（フェーズ1.1）

---

### 🔄 17. バックエンドサーバーの実装（GCP最適化版）

**ステータス**: 未着手

**理由**:
- フロントエンドとゲームロジックが完成
- サーバーとWebSocket通信の実装が必要
- GCP e2-micro（1GB RAM、1GB/月ネットワーク）での運用を前提

**作成内容**:
- [ ] Expressサーバーの初期化
- [ ] Socket.ioの設定（同時接続数70制限）
- [ ] Prismaスキーマの作成（Supabase接続）
- [ ] データベースマイグレーション
- [ ] Redisキャッシュの統合（Upstash）
- [ ] WebSocket接続ハンドラーの実装
- [ ] GameEngineとの統合
- [ ] gzip圧縮の有効化（ネットワーク転送量削減）
- [ ] レート制限の実装
- [ ] メモリ使用量監視

**GCP最適化のポイント**:
- Node.jsヒープメモリを384MBに制限（`--max-old-space-size=384`）
- 同時接続数を70に制限（メモリ管理）
- WebSocketメッセージを最小化（差分のみ送信）
- gzip圧縮でネットワーク転送量を削減
- Redisでゲーム状態をキャッシュ（メモリ節約）

**成果物**:
- `src/server/src/index.ts`（GCP最適化版）
- `src/server/src/websocket/connection.ts`（Redis統合）
- `src/database/prisma/schema.prisma`
- `src/server/package.json`（メモリ制限設定）

**関連ドキュメント**:
- `system/architecture.md` - サーバーアーキテクチャ
- `system/gcp_optimized_design.md` - GCP最適化設計
- `system/implementation_roadmap.md` - 実装手順（フェーズ1、フェーズ4）

---

### ⏳ 18. アイテムショップUIの実装

**ステータス**: 未着手

**理由**:
- アイテムシステムのゲームルールは完成
- ショップUIの実装が必要

**作成内容**:
- [ ] ItemShopコンポーネントの実装
- [ ] アイテムリスト表示
- [ ] フィルター・ソート機能
- [ ] アイテム詳細表示
- [ ] 合成レシピ表示
- [ ] 購入機能

**成果物**:
- `src/client/src/components/ItemShop.tsx`

**関連ドキュメント**:
- `docs/item_system.md` - アイテムシステムルール
- `docs/ui_design.md` - アイテムショップUI設計

---

### ⏳ 19. ゲーム前画面の実装

**ステータス**: 未着手

**理由**:
- ゲーム開始前のUI（メニュー、ロビー、キャラ選択）が必要

**作成内容**:
- [ ] MainMenuコンポーネント
- [ ] Lobbyコンポーネント（ルーム作成・参加）
- [ ] CharacterSelectionコンポーネント
- [ ] ロール・レーン選択UI
- [ ] プレイモード選択

**成果物**:
- `src/client/src/components/MainMenu.tsx`
- `src/client/src/components/Lobby.tsx`
- `src/client/src/components/CharacterSelection.tsx`

**関連ドキュメント**:
- `docs/play_modes.md` - プレイモード詳細
- `docs/ui_design.md` - ゲーム前画面UI設計

---

### ⏳ 20. ゲーム機能の統合

**ステータス**: 未着手

**理由**:
- すべてのコンポーネントを統合してゲームとして動作させる必要

**作成内容**:
- [ ] クライアント・サーバー接続テスト
- [ ] ラウンド進行の実装
- [ ] リアルタイム状態同期
- [ ] スキルシステムの実装
- [ ] ミニオン・タワーシステムの実装
- [ ] オブジェクトシステムの実装

**成果物**:
- 統合されたゲームアプリケーション

**関連ドキュメント**:
- すべてのゲームルールドキュメント
- `system/implementation_roadmap.md` - 実装手順（フェーズ5〜6）

---

### ⏳ 21. テストとデプロイ（GCP最適化版）

**ステータス**: 未着手

**理由**:
- ゲームの品質保証とデプロイが必要
- GCP e2-micro（無料枠）での運用を前提

**作成内容**:
- [ ] ユニットテスト
- [ ] 統合テスト
- [ ] E2Eテスト
- [ ] Vercelへのフロントエンドデプロイ（無料100GB/月）
- [ ] GCP e2-microへのバックエンドデプロイ（無料枠）
- [ ] Nginxリバースプロキシの設定
- [ ] PM2プロセス管理の設定（メモリ制限付き）
- [ ] SSL/TLS設定（Let's Encrypt）
- [ ] モニタリング設定（メモリ、ネットワーク転送量）

**GCP最適化のポイント**:
- フロントエンド: Vercelで配信（100GB/月無料）
- バックエンド: GCP e2-micro（1GB RAM、1GB/月ネットワーク）
- DB: Supabase（無料500MB）
- Redis: Upstash（無料256MB）
- メモリ制限: Node.js 384MB、PM2自動再起動400MB
- 同時接続数: 最大70接続

**成果物**:
- テストスイート
- デプロイスクリプト（`deploy_gcp.sh`）
- Nginx設定ファイル
- PM2設定ファイル
- モニタリングスクリプト
- デプロイされたアプリケーション

**関連ドキュメント**:
- `system/gcp_optimized_design.md` - GCPデプロイ設計
- `system/implementation_roadmap.md` - 実装手順（フェーズ7）

---

## 優先順位

### ゲームルール＆システム設計（完了）
1. ✅ **完了**: アイテムシステム
2. ✅ **完了**: リコールシステム、時間管理システム、バフ効果
3. ✅ **完了**: ゲームルール全体の整合性確認
4. ✅ **完了**: ミニオンシステムとタワー攻撃メカニクス
5. ✅ **完了**: ゲームバランス設定システム
6. ✅ **完了**: ゲームシステムの大規模な見直しと簡略化
7. ✅ **完了**: ポジショニングルールの調整
8. ✅ **完了**: プレイモードシステムとプレイヤー管理
9. ✅ **完了**: システム設計（アーキテクチャ、技術スタック、ホスティング設計）

### 実装フェーズ（進行中）
10. ✅ **完了**: ゲームロジック実装（ConfigLoader、GameEngine、Combat等）
11. ✅ **完了**: フロントエンド基盤構築（React、Vite、Zustand等）
12. ✅ **完了**: UI設計とビジュアルマップ（MapView、ActionPanel、CombatLog）
13. 🔄 **次**: 外部サービスのセットアップ（Supabase、Upstash）⭐ **GCP最適化**
14. ⏳ **未着手**: バックエンドサーバーの実装（GCP最適化版）
15. ⏳ **未着手**: アイテムショップUIの実装
16. ⏳ **未着手**: ゲーム前画面の実装
17. ⏳ **未着手**: ゲーム機能の統合
18. ⏳ **未着手**: テストとデプロイ（GCP最適化版）

---

## メモ

### ゲームルールドキュメント一覧

- `play_modes.md` - プレイモード（チュートリアル、CPU練習、カジュアル、ランク1vs1、ランク5vs5）
- `game_overview.md` - ゲーム概要、プレイヤー管理、マップ構造、ラウンド構造、勝利条件
- `character_system.md` - キャラクターシステム、ステータス、レベルアップ、スキル
- `combat_system.md` - 視界、戦闘、マッチアップ判定、ダメージ計算、デスペナルティ、複数人戦闘、タワー攻撃
- `gameplay_systems.md` - ガンク、タワー、オブジェクト、リソース管理、リコールシステム、ミニオンシステム
- `item_system.md` - アイテムシステム（完成）
- `buff_system.md` - バフシステム（赤バフ、青バフ、ドラゴン、バロン、ヘラルド）
- `time_management.md` - 時間管理システム、ゲームフェーズ、ラウンドと時間の対応
- `game_rules.md` - 統合ドキュメント（整合性確認済み）

### システム設計ドキュメント一覧

- `system/architecture.md` - システムアーキテクチャ設計、データベース設計、API設計
- `system/technology_stack.md` - 技術スタック詳細（React、Node.js、PostgreSQL等）
- `system/configuration_management.md` - 設定管理設計（game_balance.yaml、ConfigLoader）
- `system/hosting_options.md` - ホスティングオプション（GCP、AWS、Heroku等）
- `system/gcp_optimized_design.md` - ⭐ **GCP最適化設計（無料枠・低コスト運用）**
  - GCP e2-micro（1GB RAM、1GB/月ネットワーク）
  - Vercel（フロントエンド、100GB/月無料）
  - Supabase PostgreSQL（無料500MB）
  - Upstash Redis（無料256MB）
- `system/implementation_roadmap.md` - ⭐ **実装ロードマップ（フェーズ0〜7の詳細チェックリスト、GCP最適化版）**

### 参考情報

- ゲームはLoL（League of Legends）をベースにしたGMレスTRPG
- ダイスロール（1d20）とステータス補正による判定システム
- 5vs5のチーム戦
- ターン制で進行

---

## 更新履歴

- 2025-11-14: GCP仕様に基づいてTODO全般を更新、情報統合完了
  - `system_todo.md`を`docs/system/implementation_roadmap.md`に移動
  - GCP最適化要件を実装ロードマップに組み込み（Supabase、Upstash、Vercel）
  - タスク16を追加：外部サービスのセットアップ（Supabase、Upstash）
  - タスク17を更新：バックエンドサーバーの実装（GCP最適化版）
  - タスク21を更新：テストとデプロイ（GCP最適化版、Vercel + GCP e2-micro）
  - システム設計ドキュメント一覧にGCP最適化情報を追加
  - すべてのTODO情報をdocs配下に統合、一元管理を実現
- 2025-11-13: ゲームルール＆システム設計フェーズ完了
  - システム設計の完了を追加（アーキテクチャ、技術スタック、ホスティング設計）
  - 実装手順書（system_todo.md）の参照を追加
  - ルートディレクトリのTodo.mdを削除（重複のため）
  - docs/TODO.mdをメインのTODOファイルとして統一
  - 次のステップ：実装フェーズ（フェーズ0〜7）
- 2025-11-11: プレイモードシステムとプレイヤー管理の追加
  - 複数プレイヤー（1〜10人）とCPU戦の要件を追加
  - プレイモード（チュートリアル、CPU練習、カジュアル、ランク1vs1、ランク5vs5）の詳細化
  - game_overview.mdにプレイヤー管理システムを追加
  - play_modes.mdを新規作成
  - game_rules.mdにplay_modes.mdへのリンクを追加
- 2025-11-11: ゲームシステムの大規模な見直しと簡略化の完了
  - ラウンドシステムへの移行（ターン制から宣言・解決フェーズ制へ）
  - 戦闘システムの簡略化（フェーズ修正・ロール相性修正の削除）
  - エリア/ポジション定義の明確化
  - 視界システムの実装
  - バフ/デバフ管理システムの実装
  - ポジショニングルールの調整（ガンク・ファーム時のルール変更）
  - TODO.mdを最新の進捗に合わせて更新
- 2025-11-11: ゲームルール開発フェーズ完了
  - ミニオンシステムとタワー攻撃メカニクスの実装完了
  - ゲームバランス設定システムの追加完了
  - ゲームルール全体の整合性確認と調整完了
  - 全タスクの完了状況を反映
- 2025-11-09: ゲームシステム大規模調整の実施
  - 複数人戦闘システムの詳細化タスクを追加
  - 未定義項目の検討タスクを追加
- 2025-11-09: TODO.md作成、アイテムシステム作業開始
